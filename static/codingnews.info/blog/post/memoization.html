<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Coding News - Memoization</title>
    <link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/feed.xml" />

    <meta name="author" content="Marcos Vanetta">
    <meta name="description" content="Blog about my experiences as a Knight Mozilla Fellow">
    <meta name="keywords" content="DDJ, Texas, open data, open source, ruby, python, JavaScript">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" href="/stylesheets/all.css">
    <style>
    .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .cm {
  color: #999988;
  font-style: italic;
}
.highlight .cp {
  color: #999999;
  font-weight: bold;
}
.highlight .c1 {
  color: #999988;
  font-style: italic;
}
.highlight .cs {
  color: #999999;
  font-weight: bold;
  font-style: italic;
}
.highlight .c, .highlight .cd {
  color: #999988;
  font-style: italic;
}
.highlight .err {
  color: #a61717;
  background-color: #e3d2d2;
}
.highlight .gd {
  color: #000000;
  background-color: #ffdddd;
}
.highlight .ge {
  color: #000000;
  font-style: italic;
}
.highlight .gr {
  color: #aa0000;
}
.highlight .gh {
  color: #999999;
}
.highlight .gi {
  color: #000000;
  background-color: #ddffdd;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
  font-weight: bold;
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .gt {
  color: #aa0000;
}
.highlight .kc {
  color: #000000;
  font-weight: bold;
}
.highlight .kd {
  color: #000000;
  font-weight: bold;
}
.highlight .kn {
  color: #000000;
  font-weight: bold;
}
.highlight .kp {
  color: #000000;
  font-weight: bold;
}
.highlight .kr {
  color: #000000;
  font-weight: bold;
}
.highlight .kt {
  color: #445588;
  font-weight: bold;
}
.highlight .k, .highlight .kv {
  color: #000000;
  font-weight: bold;
}
.highlight .mf {
  color: #009999;
}
.highlight .mh {
  color: #009999;
}
.highlight .il {
  color: #009999;
}
.highlight .mi {
  color: #009999;
}
.highlight .mo {
  color: #009999;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #009999;
}
.highlight .sb {
  color: #d14;
}
.highlight .sc {
  color: #d14;
}
.highlight .sd {
  color: #d14;
}
.highlight .s2 {
  color: #d14;
}
.highlight .se {
  color: #d14;
}
.highlight .sh {
  color: #d14;
}
.highlight .si {
  color: #d14;
}
.highlight .sx {
  color: #d14;
}
.highlight .sr {
  color: #009926;
}
.highlight .s1 {
  color: #d14;
}
.highlight .ss {
  color: #990073;
}
.highlight .s {
  color: #d14;
}
.highlight .na {
  color: #008080;
}
.highlight .bp {
  color: #999999;
}
.highlight .nb {
  color: #0086B3;
}
.highlight .nc {
  color: #445588;
  font-weight: bold;
}
.highlight .no {
  color: #008080;
}
.highlight .nd {
  color: #3c5d5d;
  font-weight: bold;
}
.highlight .ni {
  color: #800080;
}
.highlight .ne {
  color: #990000;
  font-weight: bold;
}
.highlight .nf {
  color: #990000;
  font-weight: bold;
}
.highlight .nl {
  color: #990000;
  font-weight: bold;
}
.highlight .nn {
  color: #555555;
}
.highlight .nt {
  color: #000080;
}
.highlight .vc {
  color: #008080;
}
.highlight .vg {
  color: #008080;
}
.highlight .vi {
  color: #008080;
}
.highlight .nv {
  color: #008080;
}
.highlight .ow {
  color: #000000;
  font-weight: bold;
}
.highlight .o {
  color: #000000;
  font-weight: bold;
}
.highlight .w {
  color: #bbbbbb;
}
.highlight {
  background-color: #f8f8f8;
}
    .highlight {
      background-color: #FFF;
    }
    </style>
    <link href='http://fonts.googleapis.com/css?family=Oxygen:400,300,700'rel='stylesheet' type='text/css'>
    <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
  </head>
  <body>
    <!--[if lt IE 7]>
        <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
    <![endif]-->
    <header class="main">
      <div class="title">
        <a href="http://codingnews.info/"><h2>CODING<strong>NEWS</strong></h2></a>
      </div>
      <div class="links">
        <ul>
          <li><a href="/about.html">About</a></li>
          <li><a href="/talks.html">Talks</a></li>
          <li><a href="http://twitter.com/malev"><i class="fa fa-twitter"></i></a></li>
          <li><a href="http://github.com/malev"><i class="fa fa-github-alt"></i></a></li>
          <li><a href="http://ar.linkedin.com/in/marcosvanetta"><i class="fa fa-linkedin"></i></a></li>
        </ul>
      </div>
      <img src="/images/100_0855.JPG" id="main-image">
    </header>
    <div class="main-container">
        <header class="article">
          <h2>Memoization</h2>
          <span class="date">
            Oct  8
          </span>
        </header>
        <article class="post">
          <p>Memoization in computer programs is a really simple concept. It&rsquo;s an optimization technique where a computer program returns a cached result when the same input occurs again. It&rsquo;s essential when working with heavy calculation algorithms or time consuming functions. It basically works like this:</p>

<ul>
<li>Something calls a function</li>
<li>Function performs calculation</li>
<li>Function stores result in a cached variable</li>
<li>Funciton returns result</li>
<li>Someting calls the same function</li>
<li>Function returns cached value instead of performing heavy calculations</li>
<li><strong>Win!</strong></li>
</ul>

<h2>Ruby</h2>

<p>In <strong>Ruby</strong>, <strong>memoization</strong> is almost part of the language thanks to Ruby&rsquo;s conditional assignment (<code>||=</code>):</p>
<pre><code class="highlight ruby"><span class="k">def</span> <span class="nf">slow_function</span>
  <span class="nb">sleep</span> <span class="mi">5</span>
  <span class="s1">'result'</span>
<span class="k">end</span>

<span class="k">def</span> <span class="nf">memoization</span>
  <span class="vi">@takes_time</span> <span class="o">||=</span> <span class="n">slow_function</span>
<span class="k">end</span>

<span class="n">memoization</span><span class="p">()</span>
<span class="c1"># Wait 5 seconds</span>
<span class="o">=&gt;</span> <span class="s1">'result'</span>
<span class="n">memoziation</span><span class="p">()</span>
<span class="c1"># Inmediateley</span>
<span class="o">=&gt;</span> <span class="s1">'result'</span>
</code></pre>

<p>We can also refactor a little bit using blocks (Ruby will treat this block as a single thing):</p>
<pre><code class="highlight ruby"><span class="k">def</span> <span class="nf">slow_function</span>
  <span class="vi">@takes_time</span> <span class="o">||=</span> <span class="k">begin</span>
    <span class="nb">sleep</span> <span class="mi">5</span>
    <span class="s1">'result'</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="n">slow_function</span><span class="p">()</span>
<span class="c1"># Wait 5 seconds</span>
<span class="o">=&gt;</span> <span class="s1">'result'</span>
<span class="n">slow_function</span><span class="p">()</span>
<span class="c1"># Inmediateley</span>
<span class="o">=&gt;</span> <span class="s1">'result'</span>
</code></pre>

<p>There is one caveat with this method. If <code>slow_function</code> returns <code>nil</code>, it will perform the heavy calculation every time. In that specific and annoying case we can use the <a href="http://ruby-doc.org/docs/keywords/1.9/Object.html#method-i-defined-3F">object method</a> <code>defined?</code>:</p>
<pre><code class="highlight ruby"><span class="k">class</span> <span class="nc">HeavyClass</span>
  <span class="k">def</span> <span class="nf">call</span>
    <span class="k">return</span> <span class="vi">@call</span> <span class="k">if</span> <span class="n">defined?</span><span class="p">(</span><span class="vi">@call</span><span class="p">)</span>
    <span class="vi">@call</span> <span class="o">=</span> <span class="n">slow_method</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">slow_method</span>
    <span class="nb">sleep</span> <span class="mi">5</span>
    <span class="kp">nil</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="n">heavy_object</span> <span class="o">=</span> <span class="no">HeavyClass</span><span class="p">.</span><span class="nf">new</span>
<span class="n">heavy_object</span><span class="p">.</span><span class="nf">call</span>
<span class="c1"># Wait 5 seconds</span>
<span class="o">=&gt;</span> <span class="kp">nil</span>
<span class="n">heavy_object</span><span class="p">.</span><span class="nf">call</span>
<span class="c1"># Inmediateley</span>
<span class="o">=&gt;</span> <span class="kp">nil</span>
</code></pre>

<p>What if we use parameters? Simple, we will use a <code>Hash</code>. We will initialize our <code>Hash</code> with a <code>block</code>. According to the <a href="http://www.ruby-doc.org/core-2.1.0/Hash.html">Ruby documentation</a> if we call our hash with an unexisting key, it will call our block as:</p>
<pre><code class="highlight ruby"><span class="nb">hash</span> <span class="o">=</span> <span class="no">Hash</span><span class="p">.</span><span class="nf">new</span> <span class="k">do</span> <span class="o">|</span><span class="n">h</span><span class="p">,</span> <span class="n">key</span><span class="o">|</span>
  <span class="n">h</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">rand</span>
<span class="k">end</span>

<span class="nb">hash</span><span class="p">[</span><span class="ss">:non_existing_key</span><span class="p">]</span>
<span class="o">=&gt;</span> <span class="mi">0</span><span class="o">.</span><span class="mi">3884906318307012</span>
<span class="nb">hash</span><span class="p">[</span><span class="ss">:other_non_existing_key</span><span class="p">]</span>
<span class="o">=&gt;</span> <span class="mi">0</span><span class="o">.</span><span class="mi">19581108461258834</span>
<span class="nb">hash</span><span class="p">[</span><span class="ss">:non_existing_key</span><span class="p">]</span>
<span class="o">=&gt;</span> <span class="mi">0</span><span class="o">.</span><span class="mi">3884906318307012</span>
</code></pre>

<p>Now, going back to our <code>memoization</code> post:</p>
<pre><code class="highlight ruby"><span class="k">def</span> <span class="nf">takes_a_while</span>
  <span class="nb">sleep</span> <span class="mi">5</span>
  <span class="s1">'result'</span>
<span class="k">end</span>

<span class="k">def</span> <span class="nf">slow_method</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
  <span class="vi">@hash</span> <span class="o">||=</span> <span class="no">Hash</span><span class="p">.</span><span class="nf">new</span> <span class="k">do</span> <span class="o">|</span><span class="n">h</span><span class="p">,</span> <span class="n">key</span><span class="o">|</span>
    <span class="n">h</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">takes_a_while</span>
  <span class="k">end</span>
  <span class="vi">@hash</span><span class="p">[</span><span class="n">param</span><span class="p">]</span>
<span class="k">end</span>

<span class="n">slow_method</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># Wait 5 seconds</span>
<span class="o">=&gt;</span> <span class="s1">'result'</span>
<span class="n">slow_method</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># Inmediately</span>
<span class="o">=&gt;</span> <span class="s1">'result'</span>
<span class="n">slow_method</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># Wait 5 seconds</span>
<span class="o">=&gt;</span> <span class="s1">'result'</span>
</code></pre>

<h2>Python</h2>

<p>Sadly, in Python things are not as easy as they are in Ruby, but that does not mean that they are impossible:</p>
<pre><code class="highlight python"><span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">sleep</span>

<span class="n">cache</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">def</span> <span class="nf">slow_method</span><span class="p">(</span><span class="n">param</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">cache</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">cache</span><span class="p">[</span><span class="n">param</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
        <span class="n">cache</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="o">=</span> <span class="n">param</span>
        <span class="k">return</span> <span class="n">cache</span><span class="p">[</span><span class="n">param</span><span class="p">]</span>
<span class="n">slow_method</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="c"># Wait 5 seconds</span>
<span class="o">=&gt;</span> <span class="mi">1</span>
<span class="n">slow_method</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="c"># Inmediately</span>
<span class="o">=&gt;</span> <span class="mi">1</span>
</code></pre>

<p>We can also define a <code>function</code> and use it as a <code>decorator</code> as in:</p>
<pre><code class="highlight python"><span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">sleep</span>

<span class="k">def</span> <span class="nf">memoize</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
    <span class="n">memo</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">def</span> <span class="nf">helper</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">memo</span><span class="p">:</span>
            <span class="n">memo</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">memo</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">helper</span>

<span class="nd">@memoize</span>
<span class="k">def</span> <span class="nf">slow_function</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">n</span>
<span class="n">slow_method</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="c"># Wait 5 seconds</span>
<span class="o">=&gt;</span> <span class="mi">1</span>
<span class="n">slow_method</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="c"># Inmediately</span>
<span class="o">=&gt;</span> <span class="mi">1</span>
</code></pre>

<p>If you are using <strong>Python 3</strong> maybe you can check <code>functools.lru_cache</code> on the <a href="https://docs.python.org/3/library/functools.html#functools.lru_cache">official documentation</a> and if you are using <strong>Django</strong> you should also check the <a href="http://pythonhosted.org/django-memoize/">django-memoize</a> library.</p>

<h2>Javascript</h2>

<p>We can define a method in the <code>Function</code> prototype and use a concept very similar as the Python one:</p>
<pre><code class="highlight javascript"><span class="nb">Function</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">memoize</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
  <span class="kd">var</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">,</span> <span class="nx">cache</span> <span class="o">=</span> <span class="p">{};</span>
  <span class="k">return</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">arg</span> <span class="p">){</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">arg</span> <span class="k">in</span> <span class="nx">cache</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">cache</span><span class="p">[</span><span class="nx">arg</span><span class="p">];</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">cache</span><span class="p">[</span><span class="nx">arg</span><span class="p">]</span> <span class="o">=</span> <span class="nx">self</span><span class="p">(</span> <span class="nx">arg</span> <span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">slow</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Heavy calculation...'</span><span class="p">);</span>
  <span class="k">return</span> <span class="mi">5</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">memSlow</span> <span class="o">=</span> <span class="nx">slow</span><span class="p">.</span><span class="nx">memoize</span><span class="p">();</span>

<span class="o">&gt;</span> <span class="nx">memSlow</span><span class="p">();</span>
<span class="nx">Heavy</span> <span class="nx">calculation</span><span class="p">...</span>
<span class="mi">5</span>
<span class="o">&gt;</span> <span class="nx">memSlow</span><span class="p">();</span>
<span class="mi">5</span>
</code></pre>

<p>But if you are using <a href="http://underscorejs.org/">underscore</a> (and your should!) you can use the <a href="http://underscorejs.org/#memoize">memoize</a> method:</p>
<pre><code class="highlight javascript"><span class="kd">var</span> <span class="nx">fibonacci</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">memoize</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">n</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="p">?</span> <span class="nx">n</span><span class="p">:</span> <span class="nx">fibonacci</span><span class="p">(</span><span class="nx">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="nx">fibonacci</span><span class="p">(</span><span class="nx">n</span> <span class="o">-</span> <span class="mi">2</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>

<p>Much easier! We define the function once, and we don&rsquo;t need to <em>memoize</em> it later.</p>

<h2>What is all this doing here?</h2>

<p>Well, if you work on data journalism you might be doing some scraping and some calculations on huge data sets. I think that the <strong>memoization</strong> concept is really useful to optimize some of your tools or scripts. Something to have in mind.</p>

        </article>
        <footer>
          <b>Tags:</b>
          <a href="/tags/programming.html">programming</a>, <a href="/tags/ruby.html">ruby</a>, <a href="/tags/javascript.html">javascript</a>, <a href="/tags/python.html">python</a>
        </footer>
        <div class="comments">
          <div id="disqus_thread"></div>
          <script type="text/javascript">
          /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
          var disqus_shortname = 'codingnews'; // required: replace example with your forum shortname

          /* * * DON'T EDIT BELOW THIS LINE * * */
          (function() {
              var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
              dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
              (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
          })();
          </script>
          <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
          <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
        </div>
    </div>
    <footer class="footer">
      <div class="resource">
        <label>Tags</label>
        <ul class="tags">
          <li><a href="/tags/scrapping.html">Scrapping (1)</a></li>
          <li><a href="/tags/dev.html">Dev (1)</a></li>
          <li><a href="/tags/random.html">Random (1)</a></li>
          <li><a href="/tags/programming.html">Programming (6)</a></li>
          <li><a href="/tags/analysis.html">Analysis (2)</a></li>
          <li><a href="/tags/python.html">Python (5)</a></li>
          <li><a href="/tags/opensource.html">Opensource (2)</a></li>
          <li><a href="/tags/ruby.html">Ruby (3)</a></li>
          <li><a href="/tags/hacking.html">Hacking (1)</a></li>
          <li><a href="/tags/conferences.html">Conferences (3)</a></li>
          <li><a href="/tags/community.html">Community (4)</a></li>
          <li><a href="/tags/open-hardware.html">Open Hardware (2)</a></li>
          <li><a href="/tags/opennews.html">Opennews (1)</a></li>
          <li><a href="/tags/community.html">Community (3)</a></li>
          <li><a href="/tags/piratebox.html">Piratebox (2)</a></li>
          <li><a href="/tags/open-internet.html">Open Internet (2)</a></li>
          <li><a href="/tags/share.html">Share (2)</a></li>
          <li><a href="/tags/hacking.html">Hacking (1)</a></li>
          <li><a href="/tags/databootcamp.html">Data Boot Camp (1)</a></li>
          <li><a href="/tags/workshop.html">Workshop (1)</a></li>
          <li><a href="/tags/javascript.html">Javascript (1)</a></li>
          <li><a href="/tags/opensource.html">Opensource (1)</a></li>
          <li><a href="/tags/open-data.html">Open Data (1)</a></li>
          <li><a href="/tags/pandas.html">Pandas (1)</a></li>
          <li><a href="/tags/dask.html">Dask (2)</a></li>
          <li><a href="/tags/boletin-oficial.html">Boletin Oficial (1)</a></li>
          <li><a href="/tags/argentina.html">Argentina (1)</a></li>
          <li><a href="/tags/data.html">Data (2)</a></li>
          <li><a href="/tags/datos.html">Datos (2)</a></li>
          <li><a href="/tags/pydata.html">Pydata (2)</a></li>
          <li><a href="/tags/nlp.html">Nlp (2)</a></li>
          <li><a href="/tags/freeling.html">Freeling (1)</a></li>
          <li><a href="/tags/nodejs.html">Nodejs (1)</a></li>
          <li><a href="/tags/data-science.html">Data Science (1)</a></li>
        </ul>
      </div>
      <div class="resource">
        <label>Resources</label>
        <ul class="links">
          <li><a href="/about.html">About</a></li>
          <li><a href="/about.html#projects">Projects</a></li>
          <li><a href="/talks.html">Talks</a></li>
          <li><a href="/feed.xml">Feed</a></li>
        </ul>
      </div>
    </footer>
    <script>
        (function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
        function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
        e=o.createElement(i);r=o.getElementsByTagName(i)[0];
        e.src='//www.google-analytics.com/analytics.js';
        r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
        ga('create','UA-29516046-2');ga('send','pageview');
    </script>
    <script type="text/javascript">
      var images = ['berlin.png', 'brussels.png', 'rosario.png', 'austin.png'],
          element = document.getElementById('main-image'),
          img;
      img = images[Math.floor(Math.random() * images.length)];

      element.setAttribute('src', '/images/' + img);
    </script>
  </body>
</html>
